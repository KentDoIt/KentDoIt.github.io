---
title: JS 展開運算子、其餘運算子
abbrlink: 1214648668
date: 2022-07-05 17:03:32
categories: JavaScript
tags:
  - ES6
  - JavaScript
description: 此篇會介紹 ES6 新增的展開運算子 Spread Operator 的兩種類型。
---

## 展開運算子（Spread Operator）

{% note primary %}
[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator)：The spread operator allows an expression to be expanded in places where multiple arguments (for function calls) or multiple elements (for array literals) or multiple variables (for destructuring assignment) are expected.
{% endnote %}

{% note default %}
白話文：就是將`函式中 參數(arguments)` 或 `陣列中元素(elements)`，透過迭代(iterable)重新組成一個新的變數。
{% endnote %}

語法：

- 在需要展開的變數前方加上三個點 `...`

{% codeblock lang:shell line_number:false %}
myFunction(a, ...iterableObj, b)
[1, ...iterableObj, '4', 'five', 6]
({ ...obj, key: 'value' })
{% endcodeblock %}

```js e.g. 將 array 展開為獨立的參數
let number = [1, 2, 3];
console.log(...number); // 1 2 3
// 等同於
console.log(number[0], number[1], number[2]);
```

> Tip

- 展開運算子如果直接用在物件上會拋出錯誤，因為展開運算子只能用於具有索引和 `length` 屬性的物件。

```js
let obj = { a: 1, b: 2 };
const array = [...obj]; // TypeError: obj is not iterable
```

### 常見應用

{% note default %}
下面會演示幾種常見應用。
{% endnote %}

#### 函式將陣列拆開當作獨立引數傳入到式中

```js
function foo(a, b, c) {
  console.log(a + b + c);
}

// ES6 寫法
foo(...[1, 2, 3]); // 6

// ES6 之前，需透過 apply() 作展開
foo.apply(null, [1, 2, 3]);  // 6
```

#### 合併陣列

```js
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];

// ES6 寫法
let temp2 = [...arr1, ...arr2];
console.log(temp2); // [1, 2, 3, 4, 5, 6]

// ES 之前寫法使用 concat()
let temp1 = arr1.concat(arr2);
console.log(temp1); // [1, 2, 3, 4, 5, 6]
```

#### 淺拷貝陣列並添加新的參數

```js
let arr1 = [1, 2, 3];
let arr2 = [...arr1];

console.log(arr2); // [1, 2, 3]
console.log(arr1 === arr2); // false
```

#### DOM 物件轉陣列

```js
const list = document.getElementsByTagName('body');

console.log(list instanceof Array); // false
console.log([...list] instanceof Array);  // true
```

#### 字串轉陣列

```js
let string = 'hello';

console.log([...'hello']);  // ['h', 'e', 'l', 'l', 'o']
```

#### 淺拷貝物件

```js
let obj = { a: 1, b: 2 };
let obj2 = { ...obj };

console.log(obj2); // { a: 1, b: 2 }
console.log(obj === obj2); // false
```

---

## 其餘運算子 Rest Operator

{% note default %}
在函式宣告中的最後一個參數加上 `...`，會稱其為「其餘運算子（Rest Operator）」，它與展開運算子效果上剛好完全相反，其餘運算子是把許多的參數組和成一個陣列。
{% endnote %}

{% note primary %}
[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters)：將函式固定參數數量變為可變參數。
{% endnote %}

語法：

- 在不確定參數數量的地方，使用上三個點 `...args` 來接收剩餘全部參數。

{% codeblock lang:shell line_number:false %}
function f(a, b, ...theArgs) {
  // ...
}
{% endcodeblock %}

```js
function foo(...args) {
  console.log(args);
}

foo(1, 2, 3); // [1, 2, 3]

function foo2(a, ...args) {
  console.log(a, args);
}

foo2(1, 2, 3); // 1, [2, 3]
```

> Tip

- 如果在箭頭函式使用其餘運算子，即使函式只有一個參數也`必須`加上小括號。

```js
let sumAll = (...number) => number.reduce((total, next) => total + next);

console.log(sumAll(1, 3, 5)); // 9
```

{% note default %}
補這個是因為，箭頭函式特性當參數只有一個時，可以把參數的小括號省略。（箭頭函式介紹可以參考這篇[文章](https://kentdoit.github.io/javascript/2638792469/#%E5%96%AE%E8%A1%8C%E5%9E%8B%E5%BC%8F%E7%B8%AE%E5%AF%AB)）
{% endnote %}

## conclusion

1. 展開運算子如果直接用在物件上會拋出錯誤，因為展開運算子只能用於具有索引和 length 屬性的物件。
2. 如果在箭頭函式使用其餘運算子，即使函式只有一個參數也`必須`加上小括號。

> 物件中的類似語法並不是 ES6 新增的特性

{% note primary %}
[Object Rest/Spread Properties for ECMAScript](https://github.com/tc39/proposal-object-rest-spread) proposal (ES2018)
{% endnote %}

```js Spread in object literals https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Spread_syntax#spread_in_object_literals src
const obj1 = { foo: 'bar', x: 42 };
const obj2 = { foo: 'baz', y: 13 };

const clonedObj = { ...obj1 };
// Object { foo: "bar", x: 42 }

const mergedObj = { ...obj1, ...obj2 };
// Object { foo: "baz", x: 42, y: 13 }
```

> 關於名詞不統一

- 在[ECMAScript](https://262.ecma-international.org/6.0/) 上使用的是 `SpreadElement` 與 `rest parameter`，並且沒有一個完整的章節介紹，而是散落在各章節中。
- 在 MDN 上是用 `Spread operator` 與 `Spread syntax` (標題是 syntax，網址是 operator)、`Rest operator`、`Rest parameters`(標題是 `parameters`，網址是 operator)。

## reference

- [[ES6-重點紀錄] 擴展運算子 Spread Operator](https://ithelp.ithome.com.tw/articles/10195477)
- 竹白大 [展開／其餘運算子](https://chupai.github.io/posts/200513_js_spread_and_rest_operator/)
- [展開運算符與其餘運算符](https://eyesofkids.gitbooks.io/javascript-start-from-es6/content/part4/rest_spread.html)
